import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

data = pd.read_csv("dairy_dataset.csv")
print(data)


print(data.info())

# 1. does number of cows in a farm has any dependency on area aquired.

gb = data.groupby("Location").agg({"Total Land Area (acres)": "sum","Number of Cows" :"count"})
print(gb)

exp = [0,0,0.1,0,0,0,0,0,0,0,0,0,0,0,0]
plt.pie(gb["Number of Cows"], labels = gb.index,autopct= "%1.2f%%",explode = exp )
plt.title("cows dependency on area aquired" ,loc = "center", fontweight = 'bold' )
plt.legend(bbox_to_anchor = (1.9,1.1))
plt.show()


# 2 what is the average expiry days of each product.

gb2 = data.groupby("Product Name").agg({"Shelf Life (days)" : "mean"})
print(gb2)

sns.barplot(data = data,x = "Product Name" , y = "Shelf Life (days)",errorbar = ("ci" , 0),palette = "spring")
plt.title("Aerage expiry days of each product." , fontweight = "bold")
plt.xlabel("Product Name" , fontsize = 17, color = "blue" )
plt.ylabel("Shelf Life (days)" , fontsize = 17, color = "Green" )
plt.xticks(rotation = 90)
plt.show()

# 3. mention the name of the products with max and min shelf life

gb3 = data.groupby("Product Name").agg(Max_shelf_Life = ("Shelf Life (days)" ,"max"),
                                      Min_shelf_Life = ("Shelf Life (days)" ,"min"))
print(gb3)


sns.heatmap(gb3)
plt.title("Products with max and min shelf life", fontweight = 'bold')
plt.xlabel("Shelf Life(Max/Min)" ,color = "red", fontsize = 15)
plt.ylabel("Product Name" , color = "green" ,fontsize = 15)
plt.show()


# 4. summarize the data on the basis of brands and land acquired by them,cows and the revenue generated by them.


gb4 = data.groupby("Brand").agg({"Total Land Area (acres)" : "sum" , "Number of Cows" : "sum"})
print(gb4)



# 5. What is the average shelf life for different storage conditions.

gb5 = data.groupby("Storage Condition").agg({"Shelf Life (days)" : "mean"})
print(gb5)

exp = [0.1,0,0,0,0]
plt.pie(gb5["Shelf Life (days)"], labels = gb5.index , autopct = "%1.2f%%", shadow = True, explode = exp)
plt.title("Average shelf life for different storage conditions.", color = "Green", fontsize = 17, fontweight = 'bold',)
plt.show()
  
